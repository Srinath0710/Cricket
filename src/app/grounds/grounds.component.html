<div class="page-wrapper">
  <div class="content container-fluid">
    <main>
      <div class="card margin-card">
        <div class="card-body">
          <div class="page-header main-page-header d-flex align-items-center justify-content-between">
            <div class="main-page-title page-title playerbackground">
              <i class="fas fa-globe-americas" aria-hidden="true"></i>
              Grounds
            </div>
            <div class="d-flex align-items-center">
 <!-- Search Form -->
              <form class="d-flex align-items-center gap-2"(submit)="gridload()">
                <div class="p-input-icon-right flex-grow-1">

                  <input pInputText type="text" [(ngModel)]="searchKeyword" name="searchKeyword" class="width-search"
                    placeholder="Search"(input)="filterGlobal()" />
                </div>

              <button type="button"  class="clear-button"  (click)="clear()"> Clear </button>

              </form>

              <div class="card flex justify-center">
                <button *ngIf="!ShowForm" class="new-button p-button-text" (click)="resetForm()"
                  (click)="showAddForm()">
                  <i class="fas fa-plus"></i>
                  Grounds
                </button>
              </div>
            </div>
          </div>
          
          <p-table #dt [value]="groundsData" [styleClass]="'custom-table'" [globalFilterFields]="['ground_name','country_name','state_name','city_name','record_status']">
            <ng-template pTemplate="header">
              <tr>
                <th class="col-3" pSortableColumn="ground_name">Ground Name <p-sortIcon field="ground_name">
                  </p-sortIcon>
                </th>
                <th class="col-2" pSortableColumn="country_name">Country Name <p-sortIcon field="country_name">
                  </p-sortIcon>
                </th>
                <th class="col-2" pSortableColumn="state_name">State Name <p-sortIcon field="state_name"></p-sortIcon>
                </th>
                <th class="col-2" pSortableColumn="city_name">City Name <p-sortIcon field="city_name"></p-sortIcon>
                </th>
                <th class="col-1" pSortableColumn="record_status">Status <p-sortIcon field="record_status"></p-sortIcon>
                </th>
                <th class="col-2" class="custom-header action-column-header">Actions</th>
              </tr>
            </ng-template>

            <ng-template pTemplate="body" let-ground>
              <tr>
                <td><span class="cursor" (click)="onViewGroundDetails(ground.ground_id)">{{ ground.ground_name }}</span></td>

      
                <td>{{ ground.country_name }}</td>
                <td>{{ ground.state_name }}</td>
                <td>{{ ground.city_name }}</td>
                <td>
                  <span [ngClass]="{
                                    ' bg-success': ground.record_status === 'Active',
                                    ' bg-danger': ground.record_status === 'InActive'
                                  }">
                    {{ ground.record_status }}
                  </span>
                </td>
                <td>
                  <span class="icon-blue" (click)="EditGround(ground)" pTooltip="Edit" tooltipPosition="top">
                    <i class="fa-solid fa-user-pen"></i>
                  </span>

                  <span class="icon-green"
                    (click)="StatusConfirm(ground.ground_id,cricketKeyConstant.condition_key.active_status)"
                    pTooltip="Activate" tooltipPosition="top">
                    <i class="fa-solid fa-circle-check"></i>
                  </span>

                  <span class="icon-red"
                    (click)="StatusConfirm(ground.ground_id,cricketKeyConstant.condition_key.deactive_status)"
                    pTootip="Deactivate" tooltipPosition="top">
                    <i class="fa-solid fa-trash-can-arrow-up"></i>
                  </span>
                </td>
              </tr>
            </ng-template>
          </p-table>


<p-dialog 
  header="Ground Details" 
  [(visible)]="viewDialogVisible" 
  [modal]="true" 
  
  [dismissableMask]="true"
>
<!-- 
<div class="popupstyle">
  <button class="close-btn" (click)="viewDialogVisible = false">X</button>

  <div class="row" *ngFor="let ground of selectedGround">
 <div class="table-row">
  <div class="First">{{ ground['ground name'] }}</div>
</div>

    <div class="divider"></div>

    <div class="table-row">
      <div class="label">ADDRESS 1</div>
      <div class="separator">|</div>
      <div class="value">{{ ground['address 1'] }}</div>
    </div>
    <div class="divider"></div>

    <div class="table-row">
      <div class="label">ADDRESS 2</div>
      <div class="separator">|</div>
      <div class="value">{{ ground['address 2'] }}</div>
    </div>
    <div class="divider"></div>

    <div class="table-row">
      <div class="label">POST CODE</div>
      <div class="separator">|</div>
      <div class="value">{{ ground['post code'] }}</div>
    </div>
    <div class="divider"></div>

    <div class="table-row">
      <div class="label">END ONE</div>
      <div class="separator">|</div>
      <div class="value">{{ ground['end one'] }}</div>
    </div>
    <div class="divider"></div>

    <div class="table-row">
      <div class="label">END TWO</div>
      <div class="separator">|</div>
      <div class="value">{{ ground['end two'] }}</div>
    </div>
    <div class="divider"></div>

    <div class="table-row">
      <div class="label"> PROFILE</div>
      <div class="separator">|</div>
      <div class="value">{{ ground.profile }}</div>
    </div>
    <div class="divider"></div>

    <div class="table-row">
      <div class="label"> COUNTRY</div>
      <div class="separator">|</div>
      <div class="value">{{ ground.country }}</div>
    </div>
    <div class="divider"></div>

    <div class="table-row">
      <div class="label"> STATE</div>
      <div class="separator">|</div>
      <div class="value">{{ ground.state }}</div>
    </div>
    <div class="divider"></div>

    <div class="table-row">
      <div class="label"> CITY  </div>
      <div class="separator">|</div>
      <div class="value">{{ ground.city }}</div>
    </div>
    <div class="divider"></div>

    <div class="table-row">
      <div class="label"> Profile Image</div>
      <div class="separator">|</div>
      <div class="value">{{ ground.profile_img }}</div>
    </div>
    <div class="divider"></div>
  </div>
  
</div> -->


<div class="popup-container">
  <button class="popup-close" (click)="viewDialogVisible = false" aria-label="Close popup">✖</button>

  <div *ngFor="let ground of selectedGround" class="popup-content">

    <header class="popup-header">
      <div class="popup-icon">🏟️</div>
      <h1 class="popup-title">{{ ground['ground name'] | uppercase }}</h1>
      <p class="popup-address">📍 {{ ground['address 1'] }} {{ ground['address 2'] }}</p>
    </header>

    <section class="popup-section">
      <h2 class="section-title">📌 Ground Details</h2>
      <div class="info-row"><span class="info-label">🔢 Post Code</span><span class="separator">|</span><span class="info-value">{{ ground['post code'] }}</span></div>
      <div class="info-row"><span class="info-label">🎯 End One</span><span class="separator">|</span><span class="info-value">{{ ground['end one'] }}</span></div>
      <div class="info-row"><span class="info-label">🏁 End Two</span><span class="separator">|</span><span class="info-value">{{ ground['end two'] }}</span></div>
      <div class="info-row"><span class="info-label">📘 Profile</span><span class="separator">|</span><span class="info-value">{{ ground.profile }}</span></div>
    </section>

    <section class="popup-section">
      <h2 class="section-title">🌍 Location</h2>
      <div class="info-row"><span class="info-label">🌎 Country</span><span class="separator">|</span><span class="info-value">{{ ground.country }}</span></div>
      <div class="info-row"><span class="info-label">🏴 State</span><span class="separator">|</span><span class="info-value">{{ ground.state }}</span></div>
      <div class="info-row"><span class="info-label">🏙️ City</span><span class="separator">|</span><span class="info-value">{{ ground.city }}</span></div>
    </section>

    <section class="popup-section">
      <h2 class="section-title">🖼️ Media</h2>
      <div class="info-row">
        <span class="info-label">🖼️ Profile Image</span><span class="separator">|</span>
        <span class="info-value image-preview" title="Click to zoom">
          <img [src]="ground.profile_img" alt="Profile Image" />
          <span class="zoom-icon">🔍</span>
        </span>
      </div>
    </section>

  </div>
</div>


</p-dialog>


          <p-paginator [rows]="rows" [totalRecords]="totalData" [first]="(first - 1) * rows"
            [rowsPerPageOptions]="[10, 25, 50,100]" (onPageChange)="onPageChange($event)">
          </p-paginator>
        </div>
      </div>
    </main>


    <p-confirmDialog [style]="{width: '300px', height: '200px'}" [baseZIndex]="10000" [draggable]="false"
      [styleClass]="'p-confirm-dialog-custom'">
    </p-confirmDialog>
    <p-drawer [(visible)]="ShowForm" [baseZIndex]="10000" position="right" [showCloseIcon]="false">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h3 class="small-heading">
          {{ isEditMode ? 'Edit Ground' : 'Add Ground' }}
        </h3>
      </div>

      <form [formGroup]="addGroundForm">
        <div class="row gy-3">

          <div class="col-md-6">
            <label class="">Ground Name
              <span class="text-danger">*</span>
            </label>
            <input class="form-control" maxlength="50" type="text" placeholder="Enter Ground Name"
              formControlName="ground_name">
            <small
              *ngIf="addGroundForm?.get('ground_name')?.invalid &&(addGroundForm?.get('ground_name')?.touched) || (addGroundForm.get('ground_name')?.invalid && submitted)"
              class="required-msg"> Ground name is Required
            </small>
          </div>

          <div class="col-md-6">
            <label class="">Dispaly Name
              <span class="text-danger">*</span>
            </label>
            <input class="form-control" maxlength="50" type="text" placeholder="Entre Dispaly Name"
              formControlName="display_name">
            <small
              *ngIf="addGroundForm?.get('display_name')?.invalid &&(addGroundForm?.get('display_name')?.touched) || (addGroundForm.get('display_name')?.invalid && submitted)"
              class="required-msg"> Ground name is Required
            </small>
          </div>

          <div class="col-md-6">
            <label class="">Address Name 1
              <span class="text-danger">*</span>
            </label>
            <input class="form-control" maxlength="50" type="text" placeholder="Entre Address 1"
              formControlName="address_1">
            <small
              *ngIf="addGroundForm?.get('address_1')?.invalid &&(addGroundForm?.get('address_1')?.touched) || (addGroundForm.get('address_1')?.invalid && submitted)"
              class="required-msg">Adress 1 is Required
            </small>
          </div>

          <div class="col-md-6">
            <label class="">Address Name 2
              <span class="text-danger">*</span>
            </label>
            <input class="form-control" maxlength="50" type="text" placeholder="Entre Address 2"
              formControlName="address_2">
            <small
              *ngIf="addGroundForm?.get('address_2')?.invalid &&(addGroundForm?.get('address_2')?.touched) || (addGroundForm.get('address_2')?.invalid && submitted)"
              class="required-msg">Adress 2 is Required
            </small>
          </div>
          <div class="col-md-6">
            <label>Country
              <span class="text-danger">*</span>
            </label>
            <p-dropdown [options]="countriesList" class="drop-error " 
            formControlName="country_id"
            (ngModelChange)="getStates(addGroundForm.get('country_id')?.value)"
              optionValue="country_id" optionLabel="country_name" placeholder="select Country"appendTo="self"  [panelStyleClass]="'custom-dropdown-panel'">
              <ng-template let-country pTemplate="item">
                <div class="flex align-items-center gap-2">
                  <div>{{ country.country_name }}
                  </div>
                </div>
              </ng-template>
            </p-dropdown>
            <small
              *ngIf="addGroundForm?.get('country_id')?.invalid &&(addGroundForm.get('country_id')?.touched) || (addGroundForm.get('country_id')?.invalid && submitted)"
              class="required-msg">Country
              Is Required
            </small>
          </div>
          <div class="col-md-6">
            <label>State
            </label>
            <p-dropdown [options]="statesList" class="drop-error " 
            formControlName="state_id"
            (ngModelChange)="getCities(addGroundForm.get('state_id')?.value)"
              optionValue="state_id" optionLabel="state_name" placeholder="select State">
              <ng-template let-state pTemplate="item">
                <div class="flex align-items-center gap-2">
                  <div>{{ state.state_name }}
                  </div>
                </div>
              </ng-template>
            </p-dropdown>
           
          </div>
          <div class="col-md-6">
            <label>City
            </label>
            <p-dropdown [options]="citiesList" class="drop-error " 
            formControlName="city_id"
              optionValue="city_id" optionLabel="city_name" placeholder="select City">
              <ng-template let-city pTemplate="item">
                <div class="flex align-items-center gap-2">
                  <div>{{ city.city_name }}
                  </div>
                </div>
              </ng-template>
            </p-dropdown>
          
          </div>

          <div class="col-md-6">
            <label class="">Post Code
              <span class="text-danger">*</span>
            </label>
            <input class="form-control" maxlength="50" type="text" placeholder="Post Code" formControlName="post_code">
            <small
              *ngIf="addGroundForm?.get('post_code')?.invalid &&(addGroundForm?.get('post_code')?.touched) || (addGroundForm.get('post_code')?.invalid && submitted)"
              class="required-msg">Post Code is Required
            </small>
          </div>

          <div class="col-md-6">
            <label class="">End One
              <span class="text-danger">*</span>
            </label>
            <input class="form-control" maxlength="50" type="text" placeholder="End One" formControlName="end_one">
            <small
              *ngIf="addGroundForm?.get('end_one')?.invalid &&(addGroundForm?.get('end_one')?.touched) || (addGroundForm.get('end_one')?.invalid && submitted)"
              class="required-msg">End One is Required
            </small>
          </div>

          <div class="col-md-6">
            <label class="">End Two
              <span class="text-danger">*</span>
            </label>
            <input class="form-control" maxlength="50" type="text" placeholder="End Two" formControlName="end_two">
            <small
              *ngIf="addGroundForm?.get('end_two')?.invalid &&(addGroundForm?.get('end_two')?.touched) || (addGroundForm.get('end_two')?.invalid && submitted)"
              class="required-msg">End Two is Required
            </small>
          </div>

          <div class="col-md-6">
            <label class="">Profile Image
            </label>
            <input class="form-control" maxlength="50" type="file" placeholder="Add Profile Image "
              formControlName="profile">

          </div>

          <div class="col-md-6">
            <label class="">Ground Photo
            </label>
            <input class="form-control" maxlength="50" type="file" placeholder="Add Ground Photo "
              formControlName="ground_photo">

          </div>

        </div>
        <div class="row mt-4 sticky-footer-buttons">
          <div class="col-12 text-end">
            <button pButton type="button" label="Cancel" class="p-button-secondary me-3"
              (click)="cancelForm()"></button>

            <button pButton type="button" label="Clear" class="p-button-secondary me-3"
              *ngIf="addGroundForm.get('country_id')?.value == '' || addGroundForm.get('country_id')?.value == null"
              (click)="resetForm()"></button>

            <button pButton type="button" label="Save" class="save-button" (click)="onAddGround()"></button>
          </div>
        </div>




      </form>

    </p-drawer>
  </div>
</div>



<!-- 
┌────────────────────────────────────────────┐
│ ✖                                          │   ← Close Button (top-right)
│                                            │
│        🏟️  **Lords Cricket Ground**        │   ← Ground Name (centered, bold)
│                                            │
│  📍 Address 1        : St John's Wood Rd   │
│  🧭 Address 2        : London NW8          │
│  🔢 Post Code        : NW8 8QN             │
│  🎯 End One          : Pavilion End        │
│  🏁 End Two          : Nursery End         │
│  📘 Ground Profile   : Historic venue      │
│  🌍 Country          : United Kingdom      │
│  🏴 State            : England             │
│  🏙️  City            : London              │
│  🖼️  Profile Image    : [Image Preview]     │ (optional if exists)
└────────────────────────────────────────────┘ -->
